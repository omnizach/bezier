!function(t,n){"object"==typeof exports&&"undefined"!=typeof module?n(exports):"function"==typeof define&&define.amd?define(["exports"],n):n(t.bezier={})}(this,function(t){"use strict";var n=function(){function t(t,n,e,i){this.p0=t,this.p1=n,this.p2=e,this.p3=i,this.startLength=0,this.endLength=1,this.segmentOffset=0,this.index=0,this.length=this.lengthAt(1)}return t.base3=function(t,n){return t*(t*(-3*n[0]+9*n[1]-9*n[2]+3*n[3])+6*n[0]-12*n[1]+6*n[2])-3*n[0]+3*n[1]},t.prototype.findT=function(t,n){t=Math.min(t,this.length),n=n||t/this.length;var e=(this.lengthAt(n)-t)/this.length;return Math.abs(e)<1e-4?n:this.findT(t,n-e/2)},t.prototype.xs=function(){return[this.p0.x,this.p1.x,this.p2.x,this.p3.x]},t.prototype.ys=function(){return[this.p0.y,this.p1.y,this.p2.y,this.p3.y]},t.prototype.x=function(t){void 0===t&&(t=0);var n=1-t;return n*n*n*this.p0.x+3*n*n*t*this.p1.x+3*n*t*t*this.p2.x+t*t*t*this.p3.x},t.prototype.y=function(t){void 0===t&&(t=0);var n=1-t;return n*n*n*this.p0.y+3*n*n*t*this.p1.y+3*n*t*t*this.p2.y+t*t*t*this.p3.y},t.prototype.point=function(t){return void 0===t&&(t=0),{x:this.x(t),y:this.y(t)}},t.prototype.lengthAt=function(n){var e=this;void 0===n&&(n=1);var i=(n=n<=0?0:n>1?1:n)/2;return t.INTEGRATION_CONSTANTS.map(function(n){var r=i*n[0]+i,s=t.base3(r,e.xs()),o=t.base3(r,e.ys());return n[1]*Math.sqrt(s*s+o*o)}).reduce(function(t,n){return t+n})},t.prototype.pointAtLength=function(t){return void 0===t&&(t=0),this.point(this.findT(t))},t.prototype.firstDerivative=function(t){void 0===t&&(t=0);var n=1-t;return{x:3*n*n*(this.p1.x-this.p0.x)+6*n*t*(this.p2.x-this.p1.x)+3*t*t*(this.p3.x-this.p2.x),y:3*n*n*(this.p1.y-this.p0.y)+6*n*t*(this.p2.y-this.p1.y)+3*t*t*(this.p3.y-this.p2.y)}},t.prototype.secondDerivative=function(t){void 0===t&&(t=0);var n=1-t;return{x:6*n*(this.p2.x-2*this.p1.x+this.p0.x)+6*t*(this.p3.x-2*this.p2.x+this.p2.x),y:6*n*(this.p2.y-2*this.p1.y+this.p0.y)+6*t*(this.p3.y-2*this.p2.y+this.p2.y)}},t.prototype.curvature=function(t){void 0===t&&(t=0);var n=this.firstDerivative(t),e=this.secondDerivative(t);return(n.x*e.y-n.y*e.x)/Math.pow(n.x*n.x+n.y*n.y,1.5)},t.prototype.tangent=function(t){void 0===t&&(t=0);var n=this.firstDerivative(t),e=Math.sqrt(n.x*n.x+n.y*n.y)||1;return{x:n.x/e,y:n.y/e}},t.prototype.normal=function(t){void 0===t&&(t=0);var n=this.tangent(t);return{x:-n.y,y:n.x}},t.prototype.stroke=function(){return"M "+this.p0.x+", "+this.p0.y+"\n            C "+this.p1.x+", "+this.p1.y+"\n              "+this.p2.x+", "+this.p2.y+"\n              "+this.p3.x+", "+this.p3.y},t.prototype.fill=function(t){var n=t/2,e=this.normal(0),i=this.normal(1);return"M "+(this.p0.x-e.x*n)+", "+(this.p0.y-e.y*n)+"\n            L "+(this.p0.x+e.x*n)+", "+(this.p0.y+e.y*n)+"\n            L "+(this.p3.x+i.x*n)+", "+(this.p3.y+i.y*n)+"\n            L "+(this.p3.x-i.x*n)+", "+(this.p3.y-i.y*n)+" Z"},t.prototype.pointTransform=function(t){void 0===t&&(t=0);var n=this.point(t),e=this.tangent(t);return"translate("+n.x+","+n.y+") rotate("+180*Math.atan2(e.y,e.x)/Math.PI+")"},t.INTEGRATION_CONSTANTS=[[-.1252,.2491],[.1252,.2491],[-.3678,.2335],[.3678,.2335],[-.5873,.2032],[.5873,.2032],[-.7699,.1601],[.7699,.1601],[-.9041,.1069],[.9041,.1069],[-.9816,.0472],[.9816,.0472]],t}(),e=function(){function t(e,i){void 0===i&&(i=!1),this.knots=e,this.closed=i,this.x=this.marshalCurve(n.prototype.x),this.y=this.marshalCurve(n.prototype.y),this.point=this.marshalCurve(n.prototype.point),this.firstDerivative=this.marshalCurve(n.prototype.firstDerivative),this.secondDerivative=this.marshalCurve(n.prototype.secondDerivative),this.curvature=this.marshalCurve(n.prototype.curvature),this.tangent=this.marshalCurve(n.prototype.tangent),this.normal=this.marshalCurve(n.prototype.normal),this.pointTransform=this.marshalCurve(n.prototype.pointTransform),this.curves=t.computeSpline(e.map(function(t){return t.x}),e.map(function(t){return t.y}),i),this.length=this.curves[this.curves.length-1].endLength,this.endT=this.curves.length}return t.computeControlPoints=function(t){var n=t.length-1,e=function(t){return t<=0?0:t>=n-1?2:1},i=new Array(n),r=function(t){return t>=n-1?0:1},s=new Array(n-1),o=new Array(n-1);i.fill(4),i[0]=2,i[n-1]=7;var p=t.slice(0,n).map(function(n,e){return n+2*t[e+1]});p.push(8*t[n-1]+t[n]);for(var h=0;h<i.length-1;h++){var u=e(h+1)/i[h];i[h+1]-=u*r(h),p[h+1]-=u*p[h]}s[n-1]=p[n-1]/i[n-1];for(h=i.length-2;h>0;h--)o[h]=2*t[h+1]-s[h+1];return o[n-1]=.5*(t[n]+s[n-1]),{p1:s,p2:o}},t.extendClosedSpline=function(n){for(var e=[],i=[],r=0;r<12;r++)e.push(n[t.mod(n.length-r-1,n.length)]);for(r=0;r<12;r++)i.push(n[r%n.length]);return e.concat(n).concat(i)},t.sliceClosedSpline=function(t){return t.slice(12,t.length-24)},t.computeSpline=function(e,i,r){void 0===r&&(r=!1),r&&(e=t.extendClosedSpline(e),i=t.extendClosedSpline(i));var s=t.computeControlPoints(e),o=t.computeControlPoints(i),p=0,h=[];r&&(e=t.sliceClosedSpline(e),i=t.sliceClosedSpline(i),s.p1=t.sliceClosedSpline(s.p1),s.p2=t.sliceClosedSpline(s.p2),o.p1=t.sliceClosedSpline(o.p1),o.p2=t.sliceClosedSpline(o.p2));for(var u=0;u<e.length-1;u++){var a=new n({x:e[u],y:i[u]},{x:s.p1[u],y:o.p1[u]},{x:s.p2[u],y:o.p2[u]},{x:e[u+1],y:i[u+1]});a.startLength=p,a.endLength=p+a.length,a.segmentOffset=u/(e.length-1),a.index=u,p+=a.length,h.push(a)}return h},t.prototype.marshalCurve=function(n){var e=this;return function(i){i=(i<0?0:i>t.ALMOST_ONE?t.ALMOST_ONE:i)*e.curves.length||0;var r=Math.trunc(i);return n.call(e.curves[r],i-r)}},t.findCurveIndex=function(n,e,i,r){var s=i+r>>1;return(n[s-1]||0)<=e&&e<=n[s]?s:e<(n[s-1]||0)?t.findCurveIndex(n,e,i,s):t.findCurveIndex(n,e,s+1,r)},t.prototype.pointAtLength=function(n){void 0===n&&(n=0);var e=t.findCurveIndex(this.curves.map(function(t){return t.endLength}),n,0,this.curves.length);return this.curves[e].pointAtLength(n-this.curves[e].startLength)},t.prototype.normalize=function(n,e){var i=this;return n=n||this.length/e||1,e=Math.ceil(this.length/n),new t(Array(e).map(function(t,e){return i.pointAtLength(e*n)}),this.closed)},t.prototype.stroke=function(){return this.curves.map(function(t){return t.stroke()}).join(" ")},t.prototype.fill=function(t){return this.curves.map(function(n){return n.fill(t)}).join(" ")},t.ALMOST_ONE=1-1e-6,t.mod=function(t,n){return(t%n+n)%n},t}();t.Curve=n,t.Spline=e,Object.defineProperty(t,"__esModule",{value:!0})});
//# sourceMappingURL=bezier.min.js.map
